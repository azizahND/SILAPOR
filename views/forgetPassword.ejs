<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Lupa Kata Sandi - SILAPOR Unand</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = { darkMode: 'class' };
        </script>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    </head>
    <body class="font-[Inter,sans-serif] antialiased min-h-screen bg-[conic-gradient(at_top_right,_var(--tw-gradient-stops))] from-[#eef2ff] via-white to-[#dcfce7] dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 transition-colors duration-300">
        <button id="theme-toggle" class="fixed top-6 right-6 z-50 p-3 rounded-full bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg border border-gray-200 dark:border-gray-700 shadow-lg hover:shadow-xl transition-all duration-300 group" aria-label="Toggle dark mode">
            <svg id="theme-toggle-dark-icon" class="w-5 h-5 text-gray-700 dark:text-gray-300 hidden dark:block group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 20 20">
                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
            </svg>
            <svg id="theme-toggle-light-icon" class="w-5 h-5 text-gray-700 dark:text-gray-300 block dark:hidden group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
            </svg>
        </button>
        <div class="min-h-screen flex items-center justify-center px-4 py-8 relative z-10">
            <div class="flex w-full max-w-xl bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/20 dark:border-gray-700/20 animate-[fade-in_0.6s_ease-out_forwards] transition-colors duration-300">
                <div class="w-full p-8 flex flex-col items-center">
                    <img src="/images/logo.png" alt="Logo" class="object-contain mb-6" style="width: 70px; height: 70px" />
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Lupa Kata Sandi?</h2>
                    <p class="text-gray-700 dark:text-gray-300 text-lg mb-4 text-center">Masukkan email yang terdaftar untuk mendapatkan link reset password.</p>

                    <!-- pop up notifications: server-side messages -->
                    <% if (typeof error !== 'undefined') { %>
                        <div id="popup-error" class="mb-4 px-4 py-3 rounded-xl bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300 font-semibold shadow">
                            <%= error %>
                        </div>
                        <script>
                            setTimeout(() => {
                                const el = document.getElementById('popup-error');
                                if (el) el.style.display = 'none';
                            }, 3500);
                        </script>
                    <% } %>

                    <% if (typeof success !== 'undefined') { %>
                        <div id="popup-success" class="mb-4 px-4 py-3 rounded-xl bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 font-semibold shadow">
                            <%= success %>
                        </div>
                        <script>
                            setTimeout(() => {
                                const el = document.getElementById('popup-success');
                                if (el) el.style.display = 'none';
                            }, 3500);
                        </script>
                    <% } %>

                    <form action="/forget-password" method="POST" class="w-full space-y-6" id="forgetForm">
                        <div class="space-y-2">
                            <label for="email" class="block text-sm font-semibold text-gray-700 dark:text-gray-300">Alamat Email</label>
                            <div class="relative group">
                                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                    <svg class="h-5 w-5 text-gray-400 dark:text-gray-500 group-focus-within:text-[#22c55e] transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207" />
                                    </svg>
                                </div>
                                <input type="email" name="email" id="email" placeholder="anda@example.com" class="w-full pl-12 pr-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:ring-4 focus:ring-[#f0fdf4] dark:focus:ring-green-900/20 focus:border-[#22c55e] transition-all duration-200 bg-white/50 dark:bg-gray-700/50 backdrop-blur-sm text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 hover:border-gray-300 dark:hover:border-gray-500" required />
                            </div>
                        </div>
                        <button type="submit" class="w-full text-white py-4 px-6 rounded-xl font-semibold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 focus:ring-4 focus:ring-[#f0fdf4] focus:outline-none bg-gradient-to-r from-[#16a34a] to-[#15803d] hover:from-[#15803d] hover:to-[#166534]" id="forgetBtn">
                            <span class="flex items-center justify-center gap-2">Kirim Link Reset</span>
                        </button>
                    </form>
                    <a href="/login" class="mt-6 text-[#16a34a] hover:text-[#15803d] dark:text-green-400 dark:hover:text-green-300 font-semibold transition-colors">Kembali ke Login</a>
                </div>
            </div>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const themeToggle = document.getElementById('theme-toggle');
                const htmlElement = document.documentElement;
                const savedTheme = localStorage.getItem('theme') || 'light';
                htmlElement.classList.toggle('dark', savedTheme === 'dark');
                themeToggle.addEventListener('click', function () {
                    htmlElement.classList.toggle('dark');
                    const currentTheme = htmlElement.classList.contains('dark') ? 'dark' : 'light';
                    localStorage.setItem('theme', currentTheme);
                });

                // client-side: show simple validation popup if email empty (optional)
                const form = document.getElementById('forgetForm');
                const btn = document.getElementById('forgetBtn');
                form.addEventListener('submit', function (e) {
                    if (!form.checkValidity()) return; // let browser show validation
                    // disable button to avoid double submit
                    btn.disabled = true;
                    btn.dataset.orig = btn.innerHTML;
                    btn.innerHTML = `<span class="flex items-center justify-center gap-2"><svg class="animate-spin w-5 h-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path></svg>Memproses...</span>`;
                });
            });
        </script>
    </body>
</html>